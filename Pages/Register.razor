@page "/register/{EventId:int}"
@inject UserSessionService Session

<EditForm Model="@registration" OnValidSubmit="HandleSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <InputText @bind-Value="registration.Name" placeholder="Your Name" />
    <ValidationMessage For="@(() => registration.Name)" />

    <InputText @bind-Value="registration.Email" placeholder="Your Email" />
    <ValidationMessage For="@(() => registration.Email)" />

    <button type="submit">Register</button>
</EditForm>

@code {
    [Parameter] public int EventId { get; set; }
    private RegistrationModel registration = new();

    protected override void OnInitialized()
    {
        registration.EventId = EventId;
    }

    private void HandleSubmit()
    {
        Session.RegistrationInfo = registration;
        Session.MarkAttendance(EventId, registration.Name);
    }
}
